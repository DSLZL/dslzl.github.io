<!DOCTYPE html>
<html>
<head>
  <title>Markdown Viewer</title>
  <meta charset="utf-8">
  <style>
    /* 样式代码 */
  </style>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    window.addEventListener('DOMContentLoaded', function() {
      function getFileList() {
        fetch('./markdown/files.json')
          .then(function(response) {
            return response.json();
          })
          .then(function(data) {
            var fileList = data.files;
            var fileTree = buildFileTree(fileList);
            document.getElementById('file-tree').innerHTML = fileTree;
          })
          .catch(function(error) {
            console.log('错误:', error);
          });
      }

      function buildFileTree(files) {
        var fileListHTML = '<ul>';
        for (var i = 0; i < files.length; i++) {
          var fileInfo = files[i];
          var isDirectory = fileInfo.type === 'directory';
          var icon = isDirectory ? '▸' : '&nbsp;&nbsp;&nbsp;&nbsp;';
          fileListHTML += '<li class="' + (isDirectory ? 'directory' : 'file') + '" data-file-path="' + fileInfo.path + '">';
          fileListHTML += '<span class="icon">' + icon + '</span>';
          fileListHTML += fileInfo.name;
          fileListHTML += '</li>';
        }
        fileListHTML += '</ul>';
        return fileListHTML;
      }

      function loadFile(filePath) {
        fetch(filePath)
          .then(function(response) {
            return response.text();
          })
          .then(function(text) {
            var markdown = marked(text);
            document.getElementById('content').innerHTML = markdown;
          })
          .catch(function(error) {
            console.log('错误:', error);
          });
      }

      document.getElementById('file-tree').addEventListener('click', function(event) {
        var target = event.target;
        if (target.tagName === 'LI') {
          var isDirectory = target.classList.contains('directory');
          var filePath = target.getAttribute('data-file-path');
          if (!isDirectory) {
            var currentSelected = document.querySelector('.file.selected');
            if (currentSelected) {
              currentSelected.classList.remove('selected');
            }
            target.classList.add('selected');
            loadFile(filePath);
          }
        }
      });

      getFileList();
    });
  </script>
</head>
<body>
  <div class="file-tree" id="file-tree"></div>
  <div id="content"></div>
</body>
</html>